<div class="rounded-2xl border border-slate-800 bg-slate-900 p-4">
  <div class="flex flex-wrap items-end justify-between gap-3">
    <div>
      <div class="text-lg font-semibold">Inventory</div>
      <div class="text-xs text-slate-400">Stock list and adjust</div>
    </div>

    <button
      type="button"
      class="rounded-lg border border-slate-700 bg-slate-800 px-3 py-2 text-xs hover:bg-slate-700"
      (click)="vm.toggleIncludeInactivos()"
    >
      include_inactivos: {{ vm.includeInactivos() ? 'true' : 'false' }}
    </button>
  </div>

  <div class="mt-3 grid gap-3">
    <div class="grid grid-cols-12 gap-2">
      <input
        class="col-span-12 md:col-span-10 rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm outline-none"
        placeholder="Search (codigo o descripcion)"
        [value]="vm.q()"
        (input)="vm.setSearch(($any($event.target)).value)"
      />
      <button
        type="button"
        class="col-span-12 md:col-span-2 rounded-lg bg-emerald-600 px-3 py-2 text-sm font-semibold text-white hover:bg-emerald-500"
        (click)="vm.applySearch()"
      >
        Search
      </button>
    </div>

    <div *ngIf="vm.error()" class="rounded-lg border border-rose-900 bg-rose-950 px-3 py-2 text-sm text-rose-200">
      {{ vm.error() }}
    </div>

    <div class="overflow-x-auto rounded-xl border border-slate-800">
      <table class="w-full text-sm">
        <thead class="bg-slate-950 text-slate-300">
        <tr>
          <th class="px-3 py-2 text-left">ID</th>
          <th class="px-3 py-2 text-left">Codigo</th>
          <th class="px-3 py-2 text-left">Descripcion</th>
          <th class="px-3 py-2 text-left">Qty</th>
          <th class="px-3 py-2 text-left">Stock min</th>
          <th class="px-3 py-2 text-right">Action</th>
        </tr>
        </thead>
        <tbody class="divide-y divide-slate-800">
        <tr *ngFor="let it of vm.data().items">
          <td class="px-3 py-2">{{ it.producto_id }}</td>
          <td class="px-3 py-2">{{ it.codigo }}</td>
          <td class="px-3 py-2">{{ it.descripcion }}</td>
          <td class="px-3 py-2">{{ it.cantidad_actual }}</td>
          <td class="px-3 py-2">{{ it.stock_min }}</td>
          <td class="px-3 py-2 text-right">
            <button
              type="button"
              class="rounded-lg border border-slate-700 bg-slate-800 px-3 py-1 text-xs hover:bg-slate-700"
              (click)="openAdjust(it.producto_id)"
            >
              Adjust
            </button>
          </td>
        </tr>

        <tr *ngIf="vm.data().items.length === 0">
          <td class="px-3 py-4 text-center text-slate-400" colspan="6">No data</td>
        </tr>
        </tbody>
      </table>
    </div>

    <div class="flex items-center justify-between text-xs text-slate-300">
      <div>Total: {{ vm.data().total }}</div>
      <div class="flex gap-2">
        <button type="button" class="rounded-lg border border-slate-700 bg-slate-800 px-3 py-1 hover:bg-slate-700" (click)="prev()">Prev</button>
        <div class="px-2 py-1">Page {{ vm.data().page }}</div>
        <button type="button" class="rounded-lg border border-slate-700 bg-slate-800 px-3 py-1 hover:bg-slate-700" (click)="next()">Next</button>
      </div>
    </div>

    <div *ngIf="adjustId()" class="rounded-2xl border border-slate-800 bg-slate-950 p-4">
      <div class="flex items-center justify-between">
        <div class="text-sm font-semibold">Adjust product {{ adjustId() }}</div>
        <button type="button" class="rounded-lg border border-slate-700 bg-slate-900 px-3 py-1 text-xs hover:bg-slate-800" (click)="closeAdjust()">
          Close
        </button>
      </div>

      <form class="mt-3 grid grid-cols-12 gap-2" [formGroup]="adjustForm" (ngSubmit)="submitAdjust()">
        <input
          class="col-span-12 md:col-span-8 rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm outline-none"
          type="number"
          placeholder="delta (ej: 5 o -2)"
          formControlName="delta"
        />
        <button class="col-span-12 md:col-span-4 rounded-lg bg-emerald-600 px-3 py-2 text-sm font-semibold text-white hover:bg-emerald-500" type="submit">
          Apply
        </button>
      </form>

      <div class="mt-2 text-xs text-slate-400">
        delta > 0 entrada, delta < 0 salida
      </div>
    </div>
  </div>
</div>
