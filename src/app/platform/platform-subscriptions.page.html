<div class="space-y-4">
  <!-- Crear suscripcion -->
  <div class="rounded-2xl border border-slate-200 bg-white p-4 flex flex-wrap items-end gap-3">
    <div class="flex-1 min-w-[200px]">
      <label class="text-sm font-medium text-slate-700">Plan</label>
      <select
        formControlName="plan_id"
        class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm"
      >
        <option *ngFor="let p of plans" [value]="p.id">
          {{ p.nombre }} — {{ p.precio }} Bs
        </option>
      </select>
    </div>

    <button
      type="button"
      class="inline-flex items-center gap-2 rounded-lg bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800"
      (click)="createSubscription()"
    >
      <span class="material-symbols-outlined text-base">add</span>
      Crear suscripcion
    </button>
  </div>

  <!-- Tabla -->
  <div class="rounded-2xl border border-slate-200 bg-white overflow-hidden">
    <table class="w-full text-sm">
      <thead class="bg-slate-50 text-slate-600">
        <tr>
          <th class="px-4 py-3 text-left">ID</th>
          <th class="px-4 py-3 text-left">Estado</th>
          <th class="px-4 py-3 text-right">Accion</th>
        </tr>
      </thead>

      <tbody class="divide-y">
        <tr *ngFor="let s of subs()" class="hover:bg-slate-50">
          <td class="px-4 py-3">{{ s.suscripcion_id }}</td>
          <td class="px-4 py-3">
            <span
              class="rounded-full px-2 py-1 text-xs font-medium"
              [ngClass]="
                s.estado === 'ACTIVA'
                  ? 'bg-emerald-50 text-emerald-700'
                  : 'bg-amber-50 text-amber-700'
              "
            >
              {{ s.estado }}
            </span>
          </td>
          <td class="px-4 py-3 text-right">
            <button
              type="button"
              class="inline-flex items-center gap-1 rounded-lg border border-slate-200 bg-white px-3 py-1 text-xs hover:bg-slate-50"
              (click)="selectForPayment(s)"
            >
              <span class="material-symbols-outlined text-base">payments</span>
              Registrar pago
            </button>
          </td>
        </tr>

        <tr *ngIf="subs().length === 0">
          <td colspan="3" class="px-4 py-8 text-center text-slate-500">
            Sin suscripciones
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- MODAL PAGO -->
<div *ngIf="showPayModal()" class="fixed inset-0 z-50 flex items-center justify-center bg-black/40">
  <div class="w-full max-w-md rounded-2xl bg-white p-6 space-y-4">
    <div class="flex items-center justify-between">
      <div class="text-lg font-semibold">Registrar pago</div>
      <button (click)="closeModal()" class="text-slate-400 hover:text-slate-600">✕</button>
    </div>

    <form [formGroup]="form" (ngSubmit)="pay()" class="space-y-3">
      <div>
        <label class="text-sm text-slate-600">Monto (Bs)</label>
        <input
          type="number"
          formControlName="monto"
          class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm"
        />
      </div>

      <div>
        <label class="text-sm text-slate-600">Metodo</label>
        <select
          formControlName="metodo"
          class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm"
        >
          <option value="QR">QR</option>
          <option value="TRANSFERENCIA">TRANSFERENCIA</option>
        </select>
      </div>

      <div class="flex justify-end gap-2 pt-2">
        <button
          type="button"
          (click)="closeModal()"
          class="rounded-lg border border-slate-200 px-4 py-2 text-sm"
        >
          Cancelar
        </button>

        <button
          type="submit"
          class="rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white hover:bg-emerald-500"
        >
          Pagar
        </button>
      </div>
    </form>
  </div>
</div>
